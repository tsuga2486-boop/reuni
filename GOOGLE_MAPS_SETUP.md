# Google Maps API セットアップガイド

このガイドでは、REUNIでGoogle Maps APIを使用するための設定手順を説明します。

---

## ステップ1: Google Cloud Console でプロジェクト作成（5分）

1. [Google Cloud Console](https://console.cloud.google.com/) を開く
2. Googleアカウントでログイン
3. 画面上部の「プロジェクトを選択」→「新しいプロジェクト」をクリック
4. プロジェクト名: `REUNI` と入力 → 「作成」をクリック

---

## ステップ2: API を有効化（2分）

1. 左メニュー「APIとサービス」→「ライブラリ」をクリック
2. 以下の2つのAPIを検索して有効化:
   - **Maps JavaScript API** → 「有効にする」をクリック
   - **Geocoding API** → 「有効にする」をクリック

---

## ステップ3: APIキー を取得（2分）

1. 左メニュー「APIとサービス」→「認証情報」をクリック
2. 「+ 認証情報を作成」→「APIキー」をクリック
3. 作成されたAPIキーをコピー

> [!IMPORTANT]
> APIキーは外部に公開しないでください。

---

## ステップ4: APIキーの制限（本番向け・2キー構成）

本番環境ではセキュリティのため、**2つのAPIキー**を作成します。

### 4-1. クライアント用キー（地図表示用）

1. 「+ 認証情報を作成」→「APIキー」をクリック
2. 作成されたキーの「編集」をクリック
3. **名前**: `REUNI-Client-Maps` など
4. **アプリケーションの制限**: 「HTTPリファラー（ウェブサイト）」を選択
5. 以下を追加:
   - `http://localhost:3001/*`（開発用）
   - `https://あなたのドメイン.com/*`（本番用）
6. **APIの制限**: 「キーを制限」を選択し、**Maps JavaScript API** のみ選択
7. 「保存」をクリック

### 4-2. サーバー用キー（住所変換用）

1. 再度「+ 認証情報を作成」→「APIキー」をクリック
2. 作成されたキーの「編集」をクリック
3. **名前**: `REUNI-Server-Geocoding` など
4. **アプリケーションの制限**: 
   - Vercelなどサーバーレス: 「なし」を選択
   - 固定IPサーバー: 「IPアドレス」を選択しサーバーIPを指定
5. **APIの制限**: 「キーを制限」を選択し、**Geocoding API** のみ選択
6. 「保存」をクリック

---

## ステップ5: 環境変数に設定

プロジェクトの `.env.local` ファイルを開き、以下を追加:

```env
# Google Maps API
# クライアント用（Maps JavaScript API - HTTPリファラー制限）
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=ここにクライアント用キー

# サーバー用（Geocoding API - 制限なしまたはIP制限）
GOOGLE_MAPS_API_KEY=ここにサーバー用キー
```

> [!NOTE]
> 開発時は同じキーでも動作しますが、本番では分けることを推奨します。

---

## ステップ6: 予算アラートの設定（推奨）

1. 左メニュー「お支払い」→「予算とアラート」をクリック
2. 「予算を作成」をクリック
3. 予算額: `$50`（または任意の額）を設定
4. アラートのしきい値を設定（50%, 90%, 100%など）

これで予期せぬ課金を防げます。

---

## 完了！

### 確認事項
- [ ] Google Cloudプロジェクトを作成した
- [ ] Maps JavaScript API を有効化した
- [ ] Geocoding API を有効化した
- [ ] クライアント用APIキーを作成（HTTPリファラー制限 + Maps JavaScript API）
- [ ] サーバー用APIキーを作成（制限なし + Geocoding API）
- [ ] `.env.local` に両方のAPIキーを追加した

